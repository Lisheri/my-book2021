# 浏览器缓存策略

## 缓存策略分为两种, 并且都是通过HTTP Header实现

### 强缓存

不会向浏览器发送请求, 直接从缓存中获取资源. 在控制台中可以看到请求返回200状态码, 但是Size显示from disk Cache 或者 from Memory Cache。

- 可以通过设置`Expiress`或者`Cache-Control`实现

### 协商缓存

强缓存失效之后, 浏览器携带缓存标识向服务器发送请求, 由服务器根据缓存标识来决定是否使用缓存的过程

- 主要有两种情况
    + 协商缓存生效, 返回304状态码从缓存中获取数据
        - 浏览器发起HTTP请求, 先到`浏览器缓存`
        - 该请求缓存结果失效(没有命中强缓存), 返回缓存标识
        - 浏览器携带缓存标识发起HTTP请求到服务器
        - 服务器返回304 标识资源没有更新
        - 浏览器向`浏览器缓存`中获取该请求的结果
        - 然后`浏览器缓存`返回该请求的结果
    + 协商缓存失效, 返回200和请求结果
        - 浏览器发起HTTP请求, 先到`浏览器缓存`
        - 该请求的缓存结果失效, 返回缓存标识
        - 携带缓存标识发起HTTP请求到服务器
        - 该资源已更新, 重新返回结果, 状态码200
        - 将新的返回结果和缓存标识写入缓存
- 协商缓存可以通过设置两种HTTP Header实现
    - ETag
    - Last-Modified